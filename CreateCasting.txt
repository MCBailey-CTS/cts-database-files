
public static void CreateCasting(Part part, GFolder folder)
{
    StepCreator stepCreator1;
    stepCreator1 = theSession.DexManager.CreateStepCreator();
    stepCreator1.ExportAs = StepCreator.ExportAsOption.Ap214;
    stepCreator1.BsplineTol = 0.001;
    stepCreator1.SettingsFile = "C:\\Program Files\\Siemens\\NX1899\\step214ug\\ugstep214.def";
    stepCreator1.BsplineTol = 0.001;
    stepCreator1.InputFile = part.FullPath;
    theSession.SetUndoMarkName(markId1, "Export STEP File Dialog");
    Session.UndoMarkId markId2;
    markId2 = theSession.SetUndoMark(Session.MarkVisibility.Invisible, "Export STEP File");
    theSession.DeleteUndoMark(markId2, null);
    Session.UndoMarkId markId3;
    markId3 = theSession.SetUndoMark(Session.MarkVisibility.Invisible, "Export STEP File");
    stepCreator1.OutputFile = step_path;
    stepCreator1.FileSaveFlag = false;
    stepCreator1.LayerMask = "1,96";
    stepCreator1.ProcessHoldFlag = true;
    NXObject nXObject1;
    nXObject1 = stepCreator1.Commit();
    theSession.DeleteUndoMark(markId3, null);
    theSession.SetUndoMarkName(markId1, "Export STEP File");
    stepCreator1.Destroy();
}
