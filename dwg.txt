public static void Dwg(string partPath, string drawingSheetName, string filePath)
{
    string directory = Path.GetDirectoryName(filePath);

    if (File.Exists(filePath))
        throw new ArgumentOutOfRangeException("output_path", "DWG \"" + filePath + "\" already exists.");

    Part part = session_.__FindOrOpen(partPath);

    DrawingSheet sheet = part.DrawingSheets
                             .ToArray()
                             .SingleOrDefault(drawingSheet => drawingSheet.Name == drawingSheetName)
                         ??
                         throw new ArgumentException(
                             $"Part \"{part.Leaf}\" does not have a sheet named \"{drawingSheetName}\".",
                             "drawingSheetName");

    UFSession.GetUFSession().Draw.IsObjectOutOfDate(sheet.Tag, out bool flag);

    if (flag)
    {
        SetLayers();
        UFSession.GetUFSession().Draw.UpdOutOfDateViews(sheet.Tag);
        part.__Save();
    }

    DxfdwgCreator dxfdwgCreator1 = session_.DexManager.CreateDxfdwgCreator();
    using (session_.__UsingBuilderDestroyer(dxfdwgCreator1))
    {
        dxfdwgCreator1.ExportData = DxfdwgCreator.ExportDataOption.Drawing;
        dxfdwgCreator1.AutoCADRevision = DxfdwgCreator.AutoCADRevisionOptions.R2004;
        dxfdwgCreator1.ViewEditMode = true;
        dxfdwgCreator1.FlattenAssembly = true;
        dxfdwgCreator1.SettingsFile = "C:\\Program Files\\Siemens\\NX 11.0\\dxfdwg\\dxfdwg.def";
        dxfdwgCreator1.ExportFrom = DxfdwgCreator.ExportFromOption.ExistingPart;
        dxfdwgCreator1.OutputFileType = DxfdwgCreator.OutputFileTypeOption.Dwg;
        dxfdwgCreator1.ObjectTypes.Curves = true;
        dxfdwgCreator1.ObjectTypes.Annotations = true;
        dxfdwgCreator1.ObjectTypes.Structures = true;
        dxfdwgCreator1.FlattenAssembly = false;
        dxfdwgCreator1.ExportData = DxfdwgCreator.ExportDataOption.Drawing;
        dxfdwgCreator1.InputFile = part.FullPath;
        dxfdwgCreator1.ProcessHoldFlag = true;
        dxfdwgCreator1.OutputFile = filePath;
        dxfdwgCreator1.WidthFactorMode = DxfdwgCreator.WidthfactorMethodOptions.AutomaticCalculation;
        dxfdwgCreator1.LayerMask = "1-256";
        dxfdwgCreator1.DrawingList = drawingSheetName;
        dxfdwgCreator1.Commit();
    }

    string switchFilePath = filePath.Replace(".dwg", ".log");

    if (File.Exists(switchFilePath))
        File.Delete(switchFilePath);
}
